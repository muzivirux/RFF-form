<!DOCTYPE html>
<html>

<head>
    <title>Sales Market Survey</title>
    <link rel="stylesheet" type="text/css" href="styles.css">
    <!-- <link rel="stylesheet" href="https://unicons.iconscout.com/release/v4.0.0/css/line.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.1.0/css/select2.min.css"> -->



</head>

<body>
    <h1>Sales Market Survey</h1>
    <form id="submit-to-google-sheet">

        <label for="name">Customer name:</label>
        <input type="text" id="name" name="Customer Name" required>

        <label for="streetAddress">Street address:</label>
        <input type="text" id="streetAddress" name="streetAddress" required>

        <label for="state">State:</label>
        <select id="state" name="State" onchange="populateCities()">
            <option value="">Choose State</option>
            <option value="Punjab">Punjab</option>
            <option value="Sindh">Sindh</option>
            <option value="Khyber Pakhtunkhwa">Khyber Pakhtunkhwa</option>
            <option value="Balochistan">Balochistan</option>
            <option value="Islamabad Capital Territory">Islamabad Capital Territory</option>
            <option value="Gilgit-Baltistan (formerly known as the Northern Areas)">Gilgit-Baltistan (formerly known as
                the Northern Areas)</option>
            <option value="Azad Jammu and Kashmir">Azad Jammu and Kashmir</option>
        </select>

        <label for="city">City:</label>
        <select id="city" name="City">
            <option value="">Select a City</option>
        </select>

        <label for="phone">Phone:</label>
        <input type="tel" id="phone" name="Phone" required pattern="[+][0-9]{12}" placeholder="+92xxxxxxxxxx">

        <label for="brandalreadybeingused">The brand already being used:</label>
        <input type="text" id="brandalreadybeingused" name="The brand already being used" required>

        <label for="ppp">Price per pack:</label>
        <input type="number" id="ppp" name="Price per pack" required min="0">

        <label for="ppCTN">Price per CTN:</label>
        <input type="number" id="ppCTN" name="Price per CTN" required min="0">

        <label for="PaymentMethod">Payment method:</label>
        <select id="paymentMethod" name="Payment Method">
            <option value="">Select a Payment Method</option>
            <option value="Cash">Cash</option>
            <option value="Bank Account">Bank Account</option>
            <option value="Credit Card">Credit Card</option>
        </select>

        <label for="dailyConsumptionKg">Daily consumption kg:</label>
        <input type="number" id="dailyConsumptionKg" name="Daily consumption kg" required min="0" pattern="[0-9]">

        <label for="Remarks">Remarks:</label>
        <input type="text" id="remarks" name="Remarks" required>

        <!-- Location fetching -->
        <div class="location">
            <label for="latitude"></label>
            <input type="text" id="latitude" name="latitude" placeholder="latitude" readonly>

            <label for="longitude"></label>
            <input type="text" id="longitude" name="longitude" placeholder="longitude" readonly>

            <button type="button" onclick="fetchLocation()">Get Location</button>
        </div>
        <input type="submit" value="Submit">
    </form>

    <script>
        // City data based on selected state
        const cityData = {
            Punjab: ["Burewala", "Vehari", "Lahore"],
            Sindh: ["Karachi"],
            "Khyber Pakhtunkhwa": ["Peshawar", "Abbottabad"],
            Balochistan: ["Quetta"],
            "Islamabad Capital Territory": ["Islamabad"],
            "Gilgit-Baltistan (formerly known as the Northern Areas)": ["Gilgit", "Skardu"],
            "Azad Jammu and Kashmir": ["Muzaffarabad"]
        };

        function populateCities() {
            const stateSelect = document.getElementById("state");
            const citySelect = document.getElementById("city");
            const selectedState = stateSelect.value;

            // Clear existing options
            citySelect.innerHTML = '<option value="">Select a City</option>';

            // Populate with cities based on selected state
            if (selectedState && cityData[selectedState]) {
                const cities = cityData[selectedState];
                for (const city of cities) {
                    const option = document.createElement("option");
                    option.value = city;
                    option.text = city;
                    citySelect.appendChild(option);
                }
            }
        }

        const scriptURL = 'https://script.google.com/macros/s/AKfycbz2d2ogbvL9Dw5uU1aDebOkG2pL-TYjfa12UxIMUypzbZv2hgJaVSR9QE4ts9S3RP_s/exec';
        const form = document.getElementById("submit-to-google-sheet");

        form.addEventListener('submit', e => {
            e.preventDefault();
            fetch(scriptURL, { method: 'POST', body: new FormData(form) })
                .then(response => alert('Success!', response))
                .catch(error => alert('Error!', error.message));
        });
    </script>

    <!-- Location fetching javascript -->
    <script>
        function fetchLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(successCallback, errorCallback);
            } else {
                alert("Geolocation is not supported by your browser.");
            }
        }

        function successCallback(position) {
            var latitude = position.coords.latitude;
            var longitude = position.coords.longitude;

            document.getElementById('latitude').value = latitude;
            document.getElementById('longitude').value = longitude;
        }

        function errorCallback(error) {
            switch (error.code) {
                case error.PERMISSION_DENIED:
                    alert("Location permission denied. Please enable location services.");
                    break;
                case error.POSITION_UNAVAILABLE:
                    alert("Location information is unavailable.");
                    break;
                case error.TIMEOUT:
                    alert("The request to get user location timed out.");
                    break;
                case error.UNKNOWN_ERROR:
                    alert("An unknown error occurred while getting the location.");
                    break;
            }

        }
    </script>
    <!-- End of Location fetching javascript -->

</body>

</html>